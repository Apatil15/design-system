@use '../../a11y';
@use '../../motion';
@use '../../spacing';
@use '../../util';
@use '../../properties' as *;

@mixin radio {
	@include set-props(
		$offset-x: spacing.rem(0.5),
	);

	display: flex;

	> * {
		margin-right: prop('offset-x');
	}

	> :last-child {
		margin-right: unset;
	}

	.#{util.prefix('field__label')} {
		font-weight: prop('font-weight-regular');
	}

	.#{util.prefix('field__desc')} {
		margin-bottom: unset;
	}
}

@mixin input {
	@include a11y.sr-only;
}

@mixin control {
	$-inner-ring: inset 0 0 0 prop('border-width') prop('body-bg');

	@include set-props(
		$radio-bg: prop('body-bg'),
		$radio-border: prop('base'),
		$border-width: 2px,
		$offset-x: spacing.rem(0.5),
	);

	position: relative;
	top: calc(#{prop('font-size-base')} * #{prop('line-height-sm')} / 2);
	display: flex;
	width: 1em;
	height: 1em;
	margin-right: prop('offset-x');
	content: '';
	background-color: prop('radio-bg');
	border: prop('border-width') solid prop('radio-border');
	border-radius: 100%;
	transition: none;
	transform: translateY(-50%);
	align-items: center;
	justify-content: center;

	:checked + & {
		@include set-props(
			$radio-bg: prop('primary'),
		);

		border-color: transparent;
		box-shadow: $-inner-ring;
	}

	.focus + &,
	:focus + & {
		@include a11y.focus-ring($-inner-ring);

		transition: none;
	}

	:invalid + & {
		@include set-props(
			$radio-bg: prop('error'),
			$radio-border: prop('error'),
		);
	}

	.disabled + &,
	:disabled + & {
		@include set-props(
			$radio-bg: prop('disabled-10'),
			$radio-border: prop('disabled-20'),
		);

		pointer-events: none;
		border-color: prop('radio-border');
	}

	.disabled:checked + &,
	:disabled:checked + &, {
		@include set-props($radio-bg: prop('disabled-20'));

		color: prop('body-bg');
		border-color: transparent;
	}
}

@mixin style {
	@include util.declare('radio') {
		.#{util.prefix('field--radio')} {
			@include radio;
		}

		.#{util.prefix('field__input')}[type='radio'] {
			@include input;
		}

		.#{util.prefix('field__control--radio')} {
			@include control;
		}
	}
}
